import{s as Bt,n as ct,r as mt,f as At}from"../chunks/scheduler.b95eede2.js";import{S as Ht,i as Lt,g as a,s as k,h as r,y as F,c as E,j as N,f as c,k as g,A as Y,a as G,z as n,B as M,C as jt,D as Dt,m as at,n as rt,e as Nt,E as Rt,F as xt,G as zt,o as st,H as qt}from"../chunks/index.724bd77e.js";import{e as ht,i as ft}from"../chunks/navigation.9ac5f080.js";const Jt=async({fetch:l})=>{let t=[];const e=await l("/api/admin/user-columns",{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});return e.ok&&(t=await e.json()),{columns:t}},te=Object.freeze(Object.defineProperty({__proto__:null,load:Jt},Symbol.toStringTag,{value:"Module"}));function Ot(l,t,e){const i=l.slice();return i[30]=t[e],i[32]=e,i}function It(l,t,e){const i=l.slice();return i[33]=t[e][0],i[34]=t[e][1],i}function wt(l){let t,e,i,s,u,m,b,_,C,f,y,I,O,U,v,A,x,P,S,R="Cancel",H,B,Z="Save",J,$,q=ht(Object.entries(l[7])),w=[];for(let T=0;T<q.length;T+=1)w[T]=Ut(It(l,q,T));return{c(){t=a("tr"),e=a("td"),i=k(),s=a("td"),u=a("input"),m=k(),b=a("td"),_=a("input"),C=k(),f=a("td"),y=a("select");for(let T=0;T<w.length;T+=1)w[T].c();I=k(),O=a("td"),U=a("input"),v=k(),A=a("td"),x=k(),P=a("td"),S=a("button"),S.textContent=R,H=k(),B=a("button"),B.textContent=Z,this.h()},l(T){t=r(T,"TR",{id:!0});var d=N(t);e=r(d,"TD",{}),N(e).forEach(c),i=E(d),s=r(d,"TD",{});var o=N(s);u=r(o,"INPUT",{type:!0,name:!0,placeholder:!0}),o.forEach(c),m=E(d),b=r(d,"TD",{});var p=N(b);_=r(p,"INPUT",{type:!0,name:!0,placeholder:!0}),p.forEach(c),C=E(d),f=r(d,"TD",{});var tt=N(f);y=r(tt,"SELECT",{name:!0});var D=N(y);for(let z=0;z<w.length;z+=1)w[z].l(D);D.forEach(c),tt.forEach(c),I=E(d),O=r(d,"TD",{});var j=N(O);U=r(j,"INPUT",{type:!0,name:!0,placeholder:!0}),j.forEach(c),v=E(d),A=r(d,"TD",{}),N(A).forEach(c),x=E(d),P=r(d,"TD",{});var K=N(P);S=r(K,"BUTTON",{type:!0,"data-svelte-h":!0}),F(S)!=="svelte-1k872l3"&&(S.textContent=R),H=E(K),B=r(K,"BUTTON",{type:!0,"data-svelte-h":!0}),F(B)!=="svelte-gfswwj"&&(B.textContent=Z),K.forEach(c),d.forEach(c),this.h()},h(){g(u,"type","text"),g(u,"name","display-name"),g(u,"placeholder","Display name"),g(_,"type","text"),g(_,"name","column-code"),g(_,"placeholder","Column code"),g(y,"name","column-type"),l[4]["column-type"]===void 0&&At(()=>l[20].call(y)),g(U,"type","text"),g(U,"name","column-name"),g(U,"placeholder","Column name"),g(S,"type","button"),g(B,"type","button"),g(t,"id","add-column")},m(T,d){G(T,t,d),n(t,e),n(t,i),n(t,s),n(s,u),Y(u,l[4]["display-name"]),n(t,m),n(t,b),n(b,_),Y(_,l[4]["column-code"]),n(t,C),n(t,f),n(f,y);for(let o=0;o<w.length;o+=1)w[o]&&w[o].m(y,null);Dt(y,l[4]["column-type"],!0),n(t,I),n(t,O),n(O,U),Y(U,l[4]["column-name"]),n(t,v),n(t,A),n(t,x),n(t,P),n(P,S),n(P,H),n(P,B),J||($=[M(u,"input",l[18]),M(_,"input",l[19]),M(y,"change",l[20]),M(U,"input",l[21]),M(S,"click",l[9]),M(B,"click",l[10])],J=!0)},p(T,d){if(d[0]&144&&u.value!==T[4]["display-name"]&&Y(u,T[4]["display-name"]),d[0]&144&&_.value!==T[4]["column-code"]&&Y(_,T[4]["column-code"]),d[0]&128){q=ht(Object.entries(T[7]));let o;for(o=0;o<q.length;o+=1){const p=It(T,q,o);w[o]?w[o].p(p,d):(w[o]=Ut(p),w[o].c(),w[o].m(y,null))}for(;o<w.length;o+=1)w[o].d(1);w.length=q.length}d[0]&144&&Dt(y,T[4]["column-type"]),d[0]&144&&U.value!==T[4]["column-name"]&&Y(U,T[4]["column-name"])},d(T){T&&c(t),jt(w,T),J=!1,mt($)}}}function Ut(l){let t,e=l[34]+"",i;return{c(){t=a("option"),i=at(e),this.h()},l(s){t=r(s,"OPTION",{});var u=N(t);i=rt(u,e),u.forEach(c),this.h()},h(){t.__value=l[33],Y(t,t.__value)},m(s,u){G(s,t,u),n(t,i)},p:ct,d(s){s&&c(t)}}}function Xt(l){let t,e,i,s=l[30]["display-name"]+"",u,m,b,_=l[30]["column-code"]+"",C,f,y,I=l[7][l[30]["column-type"]]+"",O,U,v,A=l[30]["column-name"]+"",x,P,S,R=l[30]["sort-order"]+"",H,B,Z;function J(o,p){return o[32]<=6?Ft:Yt}let q=J(l)(l);function w(o,p){return o[32]<=6?Kt:Mt}let d=w(l)(l);return{c(){t=a("tr"),q.c(),e=k(),i=a("td"),u=at(s),m=k(),b=a("td"),C=at(_),f=k(),y=a("td"),O=at(I),U=k(),v=a("td"),x=at(A),P=k(),S=a("td"),H=at(R),B=k(),d.c(),Z=k()},l(o){t=r(o,"TR",{});var p=N(t);q.l(p),e=E(p),i=r(p,"TD",{});var tt=N(i);u=rt(tt,s),tt.forEach(c),m=E(p),b=r(p,"TD",{});var D=N(b);C=rt(D,_),D.forEach(c),f=E(p),y=r(p,"TD",{});var j=N(y);O=rt(j,I),j.forEach(c),U=E(p),v=r(p,"TD",{});var K=N(v);x=rt(K,A),K.forEach(c),P=E(p),S=r(p,"TD",{});var z=N(S);H=rt(z,R),z.forEach(c),B=E(p),d.l(p),Z=E(p),p.forEach(c)},m(o,p){G(o,t,p),q.m(t,null),n(t,e),n(t,i),n(i,u),n(t,m),n(t,b),n(b,C),n(t,f),n(t,y),n(y,O),n(t,U),n(t,v),n(v,x),n(t,P),n(t,S),n(S,H),n(t,B),d.m(t,null),n(t,Z)},p(o,p){q.p(o,p),p[0]&2&&s!==(s=o[30]["display-name"]+"")&&st(u,s),p[0]&2&&_!==(_=o[30]["column-code"]+"")&&st(C,_),p[0]&2&&I!==(I=o[7][o[30]["column-type"]]+"")&&st(O,I),p[0]&2&&A!==(A=o[30]["column-name"]+"")&&st(x,A),p[0]&2&&R!==(R=o[30]["sort-order"]+"")&&st(H,R),d.p(o,p)},d(o){o&&c(t),q.d(),d.d()}}}function Gt(l){let t,e,i,s,u,m,b,_,C,f,y=l[7][l[30]["column-type"]]+"",I,O,U,v,A,x,P,S,R,H,B="Cancel",Z,J,$="Save",q,w,T;return{c(){t=a("tr"),e=a("td"),i=k(),s=a("td"),u=a("input"),m=k(),b=a("td"),_=a("input"),C=k(),f=a("td"),I=at(y),O=k(),U=a("td"),v=a("input"),A=k(),x=a("td"),P=a("input"),S=k(),R=a("td"),H=a("button"),H.textContent=B,Z=k(),J=a("button"),J.textContent=$,q=k(),this.h()},l(d){t=r(d,"TR",{});var o=N(t);e=r(o,"TD",{}),N(e).forEach(c),i=E(o),s=r(o,"TD",{});var p=N(s);u=r(p,"INPUT",{type:!0,name:!0,placeholder:!0}),p.forEach(c),m=E(o),b=r(o,"TD",{});var tt=N(b);_=r(tt,"INPUT",{type:!0,name:!0,placeholder:!0}),tt.forEach(c),C=E(o),f=r(o,"TD",{});var D=N(f);I=rt(D,y),D.forEach(c),O=E(o),U=r(o,"TD",{});var j=N(U);v=r(j,"INPUT",{type:!0,name:!0,placeholder:!0}),j.forEach(c),A=E(o),x=r(o,"TD",{});var K=N(x);P=r(K,"INPUT",{type:!0,name:!0}),K.forEach(c),S=E(o),R=r(o,"TD",{});var z=N(R);H=r(z,"BUTTON",{type:!0,"data-svelte-h":!0}),F(H)!=="svelte-5czny3"&&(H.textContent=B),Z=E(z),J=r(z,"BUTTON",{type:!0,"data-svelte-h":!0}),F(J)!=="svelte-wlee15"&&(J.textContent=$),z.forEach(c),q=E(o),o.forEach(c),this.h()},h(){g(u,"type","text"),g(u,"name","display-name"),g(u,"placeholder","Display name"),g(_,"type","text"),g(_,"name","column-code"),g(_,"placeholder","Column code"),g(v,"type","text"),g(v,"name","column-name"),g(v,"placeholder","Column name"),g(P,"type","number"),g(P,"name","sort-order"),g(H,"type","button"),g(J,"type","button")},m(d,o){G(d,t,o),n(t,e),n(t,i),n(t,s),n(s,u),Y(u,l[5]["display-name"]),n(t,m),n(t,b),n(b,_),Y(_,l[5]["column-code"]),n(t,C),n(t,f),n(f,I),n(t,O),n(t,U),n(U,v),Y(v,l[5]["column-name"]),n(t,A),n(t,x),n(x,P),Y(P,l[5]["sort-order"]),n(t,S),n(t,R),n(R,H),n(R,Z),n(R,J),n(t,q),w||(T=[M(u,"input",l[22]),M(_,"input",l[23]),M(v,"input",l[24]),M(P,"input",l[25]),M(H,"click",l[12]),M(J,"click",l[13])],w=!0)},p(d,o){o[0]&32&&u.value!==d[5]["display-name"]&&Y(u,d[5]["display-name"]),o[0]&32&&_.value!==d[5]["column-code"]&&Y(_,d[5]["column-code"]),o[0]&2&&y!==(y=d[7][d[30]["column-type"]]+"")&&st(I,y),o[0]&32&&v.value!==d[5]["column-name"]&&Y(v,d[5]["column-name"]),o[0]&32&&xt(P.value)!==d[5]["sort-order"]&&Y(P,d[5]["sort-order"])},d(d){d&&c(t),w=!1,mt(T)}}}function Yt(l){let t,e,i,s=!1,u,m,b;return u=qt(l[27][0]),{c(){t=a("td"),e=a("input"),this.h()},l(_){t=r(_,"TD",{});var C=N(t);e=r(C,"INPUT",{type:!0}),C.forEach(c),this.h()},h(){g(e,"type","checkbox"),e.__value=i=l[30].idx,Y(e,e.__value),u.p(e)},m(_,C){G(_,t,C),n(t,e),e.checked=~(l[0]||[]).indexOf(e.__value),m||(b=M(e,"change",l[26]),m=!0)},p(_,C){C[0]&2&&i!==(i=_[30].idx)&&(e.__value=i,Y(e,e.__value),s=!0),(s||C[0]&3)&&(e.checked=~(_[0]||[]).indexOf(e.__value))},d(_){_&&c(t),u.r(),m=!1,b()}}}function Ft(l){let t;return{c(){t=a("td")},l(e){t=r(e,"TD",{}),N(t).forEach(c)},m(e,i){G(e,t,i)},p:ct,d(e){e&&c(t)}}}function Mt(l){let t,e,i="Edit",s,u,m="Delete",b,_;function C(){return l[28](l[32])}function f(){return l[29](l[32])}return{c(){t=a("td"),e=a("button"),e.textContent=i,s=k(),u=a("button"),u.textContent=m,this.h()},l(y){t=r(y,"TD",{});var I=N(t);e=r(I,"BUTTON",{type:!0,"data-svelte-h":!0}),F(e)!=="svelte-ba0ha4"&&(e.textContent=i),s=E(I),u=r(I,"BUTTON",{type:!0,"data-svelte-h":!0}),F(u)!=="svelte-1glcjy2"&&(u.textContent=m),I.forEach(c),this.h()},h(){g(e,"type","button"),g(u,"type","button")},m(y,I){G(y,t,I),n(t,e),n(t,s),n(t,u),b||(_=[M(e,"click",C),M(u,"click",f)],b=!0)},p(y,I){l=y},d(y){y&&c(t),b=!1,mt(_)}}}function Kt(l){let t;return{c(){t=a("td")},l(e){t=r(e,"TD",{}),N(t).forEach(c)},m(e,i){G(e,t,i)},p:ct,d(e){e&&c(t)}}}function Pt(l){let t;function e(u,m){return u[2]==u[32]?Gt:Xt}let i=e(l),s=i(l);return{c(){s.c(),t=Nt()},l(u){s.l(u),t=Nt()},m(u,m){s.m(u,m),G(u,t,m)},p(u,m){i===(i=e(u))&&s?s.p(u,m):(s.d(1),s=i(u),s&&(s.c(),s.m(t.parentNode,t)))},d(u){u&&c(t),s.d(u)}}}function Qt(l){let t,e="Admin / User columns",i,s,u="User fields",m,b,_="Add column",C,f,y="Delete selected columns",I,O,U,v,A,x,P,S,R="Display name",H,B,Z="Column code",J,$,q="Column type",w,T,d="Column name",o,p,tt="Sort Order",D,j,K="Control",z,dt,ut,_t,et,nt,Ct="Text",lt,bt="Number Integer",ot,Tt="Number Real",vt,kt,W=l[3]&&wt(l),it=ht(l[1]),Q=[];for(let h=0;h<it.length;h+=1)Q[h]=Pt(Ot(l,it,h));return{c(){t=a("h1"),t.textContent=e,i=k(),s=a("h1"),s.textContent=u,m=k(),b=a("button"),b.textContent=_,C=k(),f=a("button"),f.textContent=y,I=k(),O=a("table"),U=a("thead"),v=a("tr"),A=a("td"),x=a("input"),P=k(),S=a("th"),S.textContent=R,H=k(),B=a("th"),B.textContent=Z,J=k(),$=a("th"),$.textContent=q,w=k(),T=a("th"),T.textContent=d,o=k(),p=a("th"),p.textContent=tt,D=k(),j=a("th"),j.textContent=K,z=k(),W&&W.c(),dt=k(),ut=a("tbody");for(let h=0;h<Q.length;h+=1)Q[h].c();_t=k(),et=a("datalist"),nt=a("option"),nt.textContent=Ct,lt=a("option"),lt.textContent=bt,ot=a("option"),ot.textContent=Tt,this.h()},l(h){t=r(h,"H1",{"data-svelte-h":!0}),F(t)!=="svelte-o3nl2"&&(t.textContent=e),i=E(h),s=r(h,"H1",{"data-svelte-h":!0}),F(s)!=="svelte-o0zdvi"&&(s.textContent=u),m=E(h),b=r(h,"BUTTON",{type:!0,"data-svelte-h":!0}),F(b)!=="svelte-13ld9q5"&&(b.textContent=_),C=E(h),f=r(h,"BUTTON",{type:!0,"data-svelte-h":!0}),F(f)!=="svelte-1kxuovt"&&(f.textContent=y),I=E(h),O=r(h,"TABLE",{id:!0});var L=N(O);U=r(L,"THEAD",{});var X=N(U);v=r(X,"TR",{});var V=N(v);A=r(V,"TD",{});var Et=N(A);x=r(Et,"INPUT",{type:!0}),Et.forEach(c),P=E(V),S=r(V,"TH",{"data-svelte-h":!0}),F(S)!=="svelte-5fbpcz"&&(S.textContent=R),H=E(V),B=r(V,"TH",{"data-svelte-h":!0}),F(B)!=="svelte-5edxmv"&&(B.textContent=Z),J=E(V),$=r(V,"TH",{"data-svelte-h":!0}),F($)!=="svelte-rfc7ms"&&($.textContent=q),w=E(V),T=r(V,"TH",{"data-svelte-h":!0}),F(T)!=="svelte-m0r1hp"&&(T.textContent=d),o=E(V),p=r(V,"TH",{"data-svelte-h":!0}),F(p)!=="svelte-30jp5e"&&(p.textContent=tt),D=E(V),j=r(V,"TH",{"data-svelte-h":!0}),F(j)!=="svelte-10rrrw5"&&(j.textContent=K),V.forEach(c),X.forEach(c),z=E(L),W&&W.l(L),dt=E(L),ut=r(L,"TBODY",{id:!0});var gt=N(ut);for(let yt=0;yt<Q.length;yt+=1)Q[yt].l(gt);gt.forEach(c),L.forEach(c),_t=E(h),et=r(h,"DATALIST",{id:!0});var pt=N(et);nt=r(pt,"OPTION",{"data-svelte-h":!0}),F(nt)!=="svelte-1mqqvia"&&(nt.textContent=Ct),lt=r(pt,"OPTION",{"data-svelte-h":!0}),F(lt)!=="svelte-1mkb7wl"&&(lt.textContent=bt),ot=r(pt,"OPTION",{"data-svelte-h":!0}),F(ot)!=="svelte-10956bv"&&(ot.textContent=Tt),pt.forEach(c),this.h()},h(){g(b,"type","button"),g(f,"type","button"),g(x,"type","checkbox"),x.checked=l[6],g(ut,"id","column-list-body"),g(O,"id","column-list-container"),nt.__value="text",Y(nt,nt.__value),lt.__value="number-integer",Y(lt,lt.__value),ot.__value="number-real",Y(ot,ot.__value),g(et,"id","column-types")},m(h,L){G(h,t,L),G(h,i,L),G(h,s,L),G(h,m,L),G(h,b,L),G(h,C,L),G(h,f,L),G(h,I,L),G(h,O,L),n(O,U),n(U,v),n(v,A),n(A,x),n(v,P),n(v,S),n(v,H),n(v,B),n(v,J),n(v,$),n(v,w),n(v,T),n(v,o),n(v,p),n(v,D),n(v,j),n(O,z),W&&W.m(O,null),n(O,dt),n(O,ut);for(let X=0;X<Q.length;X+=1)Q[X]&&Q[X].m(ut,null);G(h,_t,L),G(h,et,L),n(et,nt),n(et,lt),n(et,ot),vt||(kt=[M(b,"click",l[17]),M(f,"click",l[15]),M(x,"click",l[8])],vt=!0)},p(h,L){if(L[0]&64&&(x.checked=h[6]),h[3]?W?W.p(h,L):(W=wt(h),W.c(),W.m(O,dt)):W&&(W.d(1),W=null),L[0]&30887){it=ht(h[1]);let X;for(X=0;X<it.length;X+=1){const V=Ot(h,it,X);Q[X]?Q[X].p(V,L):(Q[X]=Pt(V),Q[X].c(),Q[X].m(ut,null))}for(;X<Q.length;X+=1)Q[X].d(1);Q.length=it.length}},i:ct,o:ct,d(h){h&&(c(t),c(i),c(s),c(m),c(b),c(C),c(f),c(I),c(O),c(_t),c(et)),W&&W.d(),jt(Q,h),vt=!1,mt(kt)}}}const St=7;function Vt(l,t,e){let i,s,{data:u}=t,m=[],b=-1,_=!1,C={},f={};const y={text:"Text","number-integer":"Number Integer","number-real":"Number Real"};function I(){s?e(0,m=[]):e(0,m=i.filter(D=>D.idx>St).map(D=>D.idx))}function O(){e(4,C={}),e(3,_=!1)}async function U(){const j=await fetch("/api/admin/user-columns",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(C)});j.ok||alert(await j.text()),O(),ft()}function v(D){e(2,b=D),e(5,f={});for(const j in i[D])e(5,f[j]=i[D][j],f)}function A(){e(5,f={}),e(2,b=-1)}async function x(){const j=await fetch("/api/admin/user-columns",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify([f])});j.ok||alert(await j.text()),A(),ft()}async function P(D){const j=i[D].idx,z=await fetch("/api/admin/user-columns",{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify([{idx:parseInt(j)}])});z.ok||alert(await z.text()),e(0,m=[]),ft()}async function S(){if(m.length==0){alert("No columns selected");return}const D=[];for(let z=0;z<m.length;z++)D.push({idx:parseInt(m[z])});const K=await fetch("/api/admin/user-columns",{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(D)});K.ok||alert(await K.text()),e(0,m=[]),ft()}const R=[[]],H=()=>{e(3,_=!0)};function B(){C["display-name"]=this.value,e(4,C),e(7,y)}function Z(){C["column-code"]=this.value,e(4,C),e(7,y)}function J(){C["column-type"]=Rt(this),e(4,C),e(7,y)}function $(){C["column-name"]=this.value,e(4,C),e(7,y)}function q(){f["display-name"]=this.value,e(5,f)}function w(){f["column-code"]=this.value,e(5,f)}function T(){f["column-name"]=this.value,e(5,f)}function d(){f["sort-order"]=xt(this.value),e(5,f)}function o(){m=zt(R[0],this.__value,this.checked),e(0,m)}const p=D=>v(D),tt=D=>P(D);return l.$$set=D=>{"data"in D&&e(16,u=D.data)},l.$$.update=()=>{l.$$.dirty[0]&65536&&e(1,i=u.columns),l.$$.dirty[0]&3&&e(6,s=m.length==i.length-St)},[m,i,b,_,C,f,s,y,I,O,U,v,A,x,P,S,u,H,B,Z,J,$,q,w,T,d,o,R,p,tt]}class ee extends Ht{constructor(t){super(),Lt(this,t,Vt,Qt,Bt,{data:16},null,[-1,-1])}}export{ee as component,te as universal};
