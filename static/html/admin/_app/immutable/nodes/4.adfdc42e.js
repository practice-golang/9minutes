import{s as At,n as ct,r as mt,f as Bt}from"../chunks/scheduler.b95eede2.js";import{S as Ht,i as Lt,g as a,s as k,h as r,x as F,c as E,j as N,f as c,k as g,z as Y,a as X,y as n,A as M,B as xt,C as Dt,m as at,n as rt,e as Nt,D as Rt,E as jt,F as zt,o as st,G as qt}from"../chunks/index.d1c2ad45.js";import{h as Jt}from"../chunks/singletons.7ab15c3c.js";function ht(l){return(l==null?void 0:l.length)!==void 0?l:Array.from(l)}const Gt=async({fetch:l})=>{let t={};const e=await l("/api/admin/user-columns",{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});return e.ok&&(t=await e.json()),{columns:t}},ee=Object.freeze(Object.defineProperty({__proto__:null,load:Gt},Symbol.toStringTag,{value:"Module"})),_t=Jt("invalidate_all");function Ot(l,t,e){const i=l.slice();return i[30]=t[e],i[32]=e,i}function It(l,t,e){const i=l.slice();return i[33]=t[e][0],i[34]=t[e][1],i}function wt(l){let t,e,i,s,u,v,T,f,b,_,C,I,O,U,m,B,j,P,S,R="Cancel",H,A,Z="Save",J,$,q=ht(Object.entries(l[7])),w=[];for(let y=0;y<q.length;y+=1)w[y]=Ut(It(l,q,y));return{c(){t=a("tr"),e=a("td"),i=k(),s=a("td"),u=a("input"),v=k(),T=a("td"),f=a("input"),b=k(),_=a("td"),C=a("select");for(let y=0;y<w.length;y+=1)w[y].c();I=k(),O=a("td"),U=a("input"),m=k(),B=a("td"),j=k(),P=a("td"),S=a("button"),S.textContent=R,H=k(),A=a("button"),A.textContent=Z,this.h()},l(y){t=r(y,"TR",{id:!0});var d=N(t);e=r(d,"TD",{}),N(e).forEach(c),i=E(d),s=r(d,"TD",{});var o=N(s);u=r(o,"INPUT",{type:!0,name:!0,placeholder:!0}),o.forEach(c),v=E(d),T=r(d,"TD",{});var p=N(T);f=r(p,"INPUT",{type:!0,name:!0,placeholder:!0}),p.forEach(c),b=E(d),_=r(d,"TD",{});var tt=N(_);C=r(tt,"SELECT",{name:!0});var D=N(C);for(let z=0;z<w.length;z+=1)w[z].l(D);D.forEach(c),tt.forEach(c),I=E(d),O=r(d,"TD",{});var x=N(O);U=r(x,"INPUT",{type:!0,name:!0,placeholder:!0}),x.forEach(c),m=E(d),B=r(d,"TD",{}),N(B).forEach(c),j=E(d),P=r(d,"TD",{});var K=N(P);S=r(K,"BUTTON",{type:!0,"data-svelte-h":!0}),F(S)!=="svelte-1k872l3"&&(S.textContent=R),H=E(K),A=r(K,"BUTTON",{type:!0,"data-svelte-h":!0}),F(A)!=="svelte-gfswwj"&&(A.textContent=Z),K.forEach(c),d.forEach(c),this.h()},h(){g(u,"type","text"),g(u,"name","display-name"),g(u,"placeholder","Display name"),g(f,"type","text"),g(f,"name","column-code"),g(f,"placeholder","Column code"),g(C,"name","column-type"),l[4]["column-type"]===void 0&&Bt(()=>l[20].call(C)),g(U,"type","text"),g(U,"name","column-name"),g(U,"placeholder","Column name"),g(S,"type","button"),g(A,"type","button"),g(t,"id","add-column")},m(y,d){X(y,t,d),n(t,e),n(t,i),n(t,s),n(s,u),Y(u,l[4]["display-name"]),n(t,v),n(t,T),n(T,f),Y(f,l[4]["column-code"]),n(t,b),n(t,_),n(_,C);for(let o=0;o<w.length;o+=1)w[o]&&w[o].m(C,null);Dt(C,l[4]["column-type"],!0),n(t,I),n(t,O),n(O,U),Y(U,l[4]["column-name"]),n(t,m),n(t,B),n(t,j),n(t,P),n(P,S),n(P,H),n(P,A),J||($=[M(u,"input",l[18]),M(f,"input",l[19]),M(C,"change",l[20]),M(U,"input",l[21]),M(S,"click",l[9]),M(A,"click",l[10])],J=!0)},p(y,d){if(d[0]&144&&u.value!==y[4]["display-name"]&&Y(u,y[4]["display-name"]),d[0]&144&&f.value!==y[4]["column-code"]&&Y(f,y[4]["column-code"]),d[0]&128){q=ht(Object.entries(y[7]));let o;for(o=0;o<q.length;o+=1){const p=It(y,q,o);w[o]?w[o].p(p,d):(w[o]=Ut(p),w[o].c(),w[o].m(C,null))}for(;o<w.length;o+=1)w[o].d(1);w.length=q.length}d[0]&144&&Dt(C,y[4]["column-type"]),d[0]&144&&U.value!==y[4]["column-name"]&&Y(U,y[4]["column-name"])},d(y){y&&c(t),xt(w,y),J=!1,mt($)}}}function Ut(l){let t,e=l[34]+"",i;return{c(){t=a("option"),i=at(e),this.h()},l(s){t=r(s,"OPTION",{});var u=N(t);i=rt(u,e),u.forEach(c),this.h()},h(){t.__value=l[33],Y(t,t.__value)},m(s,u){X(s,t,u),n(t,i)},p:ct,d(s){s&&c(t)}}}function Xt(l){let t,e,i,s=l[30]["display-name"]+"",u,v,T,f=l[30]["column-code"]+"",b,_,C,I=l[7][l[30]["column-type"]]+"",O,U,m,B=l[30]["column-name"]+"",j,P,S,R=l[30]["sort-order"]+"",H,A,Z;function J(o,p){return o[32]<=6?Mt:Ft}let q=J(l)(l);function w(o,p){return o[32]<=6?Qt:Kt}let d=w(l)(l);return{c(){t=a("tr"),q.c(),e=k(),i=a("td"),u=at(s),v=k(),T=a("td"),b=at(f),_=k(),C=a("td"),O=at(I),U=k(),m=a("td"),j=at(B),P=k(),S=a("td"),H=at(R),A=k(),d.c(),Z=k()},l(o){t=r(o,"TR",{});var p=N(t);q.l(p),e=E(p),i=r(p,"TD",{});var tt=N(i);u=rt(tt,s),tt.forEach(c),v=E(p),T=r(p,"TD",{});var D=N(T);b=rt(D,f),D.forEach(c),_=E(p),C=r(p,"TD",{});var x=N(C);O=rt(x,I),x.forEach(c),U=E(p),m=r(p,"TD",{});var K=N(m);j=rt(K,B),K.forEach(c),P=E(p),S=r(p,"TD",{});var z=N(S);H=rt(z,R),z.forEach(c),A=E(p),d.l(p),Z=E(p),p.forEach(c)},m(o,p){X(o,t,p),q.m(t,null),n(t,e),n(t,i),n(i,u),n(t,v),n(t,T),n(T,b),n(t,_),n(t,C),n(C,O),n(t,U),n(t,m),n(m,j),n(t,P),n(t,S),n(S,H),n(t,A),d.m(t,null),n(t,Z)},p(o,p){q.p(o,p),p[0]&2&&s!==(s=o[30]["display-name"]+"")&&st(u,s),p[0]&2&&f!==(f=o[30]["column-code"]+"")&&st(b,f),p[0]&2&&I!==(I=o[7][o[30]["column-type"]]+"")&&st(O,I),p[0]&2&&B!==(B=o[30]["column-name"]+"")&&st(j,B),p[0]&2&&R!==(R=o[30]["sort-order"]+"")&&st(H,R),d.p(o,p)},d(o){o&&c(t),q.d(),d.d()}}}function Yt(l){let t,e,i,s,u,v,T,f,b,_,C=l[7][l[30]["column-type"]]+"",I,O,U,m,B,j,P,S,R,H,A="Cancel",Z,J,$="Save",q,w,y;return{c(){t=a("tr"),e=a("td"),i=k(),s=a("td"),u=a("input"),v=k(),T=a("td"),f=a("input"),b=k(),_=a("td"),I=at(C),O=k(),U=a("td"),m=a("input"),B=k(),j=a("td"),P=a("input"),S=k(),R=a("td"),H=a("button"),H.textContent=A,Z=k(),J=a("button"),J.textContent=$,q=k(),this.h()},l(d){t=r(d,"TR",{});var o=N(t);e=r(o,"TD",{}),N(e).forEach(c),i=E(o),s=r(o,"TD",{});var p=N(s);u=r(p,"INPUT",{type:!0,name:!0,placeholder:!0}),p.forEach(c),v=E(o),T=r(o,"TD",{});var tt=N(T);f=r(tt,"INPUT",{type:!0,name:!0,placeholder:!0}),tt.forEach(c),b=E(o),_=r(o,"TD",{});var D=N(_);I=rt(D,C),D.forEach(c),O=E(o),U=r(o,"TD",{});var x=N(U);m=r(x,"INPUT",{type:!0,name:!0,placeholder:!0}),x.forEach(c),B=E(o),j=r(o,"TD",{});var K=N(j);P=r(K,"INPUT",{type:!0,name:!0}),K.forEach(c),S=E(o),R=r(o,"TD",{});var z=N(R);H=r(z,"BUTTON",{type:!0,"data-svelte-h":!0}),F(H)!=="svelte-5czny3"&&(H.textContent=A),Z=E(z),J=r(z,"BUTTON",{type:!0,"data-svelte-h":!0}),F(J)!=="svelte-wlee15"&&(J.textContent=$),z.forEach(c),q=E(o),o.forEach(c),this.h()},h(){g(u,"type","text"),g(u,"name","display-name"),g(u,"placeholder","Display name"),g(f,"type","text"),g(f,"name","column-code"),g(f,"placeholder","Column code"),g(m,"type","text"),g(m,"name","column-name"),g(m,"placeholder","Column name"),g(P,"type","number"),g(P,"name","sort-order"),g(H,"type","button"),g(J,"type","button")},m(d,o){X(d,t,o),n(t,e),n(t,i),n(t,s),n(s,u),Y(u,l[5]["display-name"]),n(t,v),n(t,T),n(T,f),Y(f,l[5]["column-code"]),n(t,b),n(t,_),n(_,I),n(t,O),n(t,U),n(U,m),Y(m,l[5]["column-name"]),n(t,B),n(t,j),n(j,P),Y(P,l[5]["sort-order"]),n(t,S),n(t,R),n(R,H),n(R,Z),n(R,J),n(t,q),w||(y=[M(u,"input",l[22]),M(f,"input",l[23]),M(m,"input",l[24]),M(P,"input",l[25]),M(H,"click",l[12]),M(J,"click",l[13])],w=!0)},p(d,o){o[0]&32&&u.value!==d[5]["display-name"]&&Y(u,d[5]["display-name"]),o[0]&32&&f.value!==d[5]["column-code"]&&Y(f,d[5]["column-code"]),o[0]&2&&C!==(C=d[7][d[30]["column-type"]]+"")&&st(I,C),o[0]&32&&m.value!==d[5]["column-name"]&&Y(m,d[5]["column-name"]),o[0]&32&&jt(P.value)!==d[5]["sort-order"]&&Y(P,d[5]["sort-order"])},d(d){d&&c(t),w=!1,mt(y)}}}function Ft(l){let t,e,i,s=!1,u,v,T;return u=qt(l[27][0]),{c(){t=a("td"),e=a("input"),this.h()},l(f){t=r(f,"TD",{});var b=N(t);e=r(b,"INPUT",{type:!0}),b.forEach(c),this.h()},h(){g(e,"type","checkbox"),e.__value=i=l[30].idx,Y(e,e.__value),u.p(e)},m(f,b){X(f,t,b),n(t,e),e.checked=~(l[0]||[]).indexOf(e.__value),v||(T=M(e,"change",l[26]),v=!0)},p(f,b){b[0]&2&&i!==(i=f[30].idx)&&(e.__value=i,Y(e,e.__value),s=!0),(s||b[0]&3)&&(e.checked=~(f[0]||[]).indexOf(e.__value))},d(f){f&&c(t),u.r(),v=!1,T()}}}function Mt(l){let t;return{c(){t=a("td")},l(e){t=r(e,"TD",{}),N(t).forEach(c)},m(e,i){X(e,t,i)},p:ct,d(e){e&&c(t)}}}function Kt(l){let t,e,i="Edit",s,u,v="Delete",T,f;function b(){return l[28](l[32])}function _(){return l[29](l[32])}return{c(){t=a("td"),e=a("button"),e.textContent=i,s=k(),u=a("button"),u.textContent=v,this.h()},l(C){t=r(C,"TD",{});var I=N(t);e=r(I,"BUTTON",{type:!0,"data-svelte-h":!0}),F(e)!=="svelte-avfy3n"&&(e.textContent=i),s=E(I),u=r(I,"BUTTON",{type:!0,"data-svelte-h":!0}),F(u)!=="svelte-knlc49"&&(u.textContent=v),I.forEach(c),this.h()},h(){g(e,"type","button"),g(u,"type","button")},m(C,I){X(C,t,I),n(t,e),n(t,s),n(t,u),T||(f=[M(e,"click",b),M(u,"click",_)],T=!0)},p(C,I){l=C},d(C){C&&c(t),T=!1,mt(f)}}}function Qt(l){let t;return{c(){t=a("td")},l(e){t=r(e,"TD",{}),N(t).forEach(c)},m(e,i){X(e,t,i)},p:ct,d(e){e&&c(t)}}}function Pt(l){let t;function e(u,v){return u[2]==u[32]?Yt:Xt}let i=e(l),s=i(l);return{c(){s.c(),t=Nt()},l(u){s.l(u),t=Nt()},m(u,v){s.m(u,v),X(u,t,v)},p(u,v){i===(i=e(u))&&s?s.p(u,v):(s.d(1),s=i(u),s&&(s.c(),s.m(t.parentNode,t)))},d(u){u&&c(t),s.d(u)}}}function Vt(l){let t,e="Admin / User columns",i,s,u="User fields",v,T,f="Add column",b,_,C="Delete selected columns",I,O,U,m,B,j,P,S,R="Display name",H,A,Z="Column code",J,$,q="Column type",w,y,d="Column name",o,p,tt="Sort Order",D,x,K="Control",z,dt,ut,ft,et,nt,bt="Text",lt,Tt="Number Integer",ot,yt="Number Real",vt,kt,W=l[3]&&wt(l),it=ht(l[1]),Q=[];for(let h=0;h<it.length;h+=1)Q[h]=Pt(Ot(l,it,h));return{c(){t=a("h1"),t.textContent=e,i=k(),s=a("h1"),s.textContent=u,v=k(),T=a("button"),T.textContent=f,b=k(),_=a("button"),_.textContent=C,I=k(),O=a("table"),U=a("thead"),m=a("tr"),B=a("td"),j=a("input"),P=k(),S=a("th"),S.textContent=R,H=k(),A=a("th"),A.textContent=Z,J=k(),$=a("th"),$.textContent=q,w=k(),y=a("th"),y.textContent=d,o=k(),p=a("th"),p.textContent=tt,D=k(),x=a("th"),x.textContent=K,z=k(),W&&W.c(),dt=k(),ut=a("tbody");for(let h=0;h<Q.length;h+=1)Q[h].c();ft=k(),et=a("datalist"),nt=a("option"),nt.textContent=bt,lt=a("option"),lt.textContent=Tt,ot=a("option"),ot.textContent=yt,this.h()},l(h){t=r(h,"H1",{"data-svelte-h":!0}),F(t)!=="svelte-o3nl2"&&(t.textContent=e),i=E(h),s=r(h,"H1",{"data-svelte-h":!0}),F(s)!=="svelte-o0zdvi"&&(s.textContent=u),v=E(h),T=r(h,"BUTTON",{type:!0,"data-svelte-h":!0}),F(T)!=="svelte-13ld9q5"&&(T.textContent=f),b=E(h),_=r(h,"BUTTON",{type:!0,"data-svelte-h":!0}),F(_)!=="svelte-1kxuovt"&&(_.textContent=C),I=E(h),O=r(h,"TABLE",{id:!0});var L=N(O);U=r(L,"THEAD",{});var G=N(U);m=r(G,"TR",{});var V=N(m);B=r(V,"TD",{});var Et=N(B);j=r(Et,"INPUT",{type:!0}),Et.forEach(c),P=E(V),S=r(V,"TH",{"data-svelte-h":!0}),F(S)!=="svelte-5fbpcz"&&(S.textContent=R),H=E(V),A=r(V,"TH",{"data-svelte-h":!0}),F(A)!=="svelte-5edxmv"&&(A.textContent=Z),J=E(V),$=r(V,"TH",{"data-svelte-h":!0}),F($)!=="svelte-rfc7ms"&&($.textContent=q),w=E(V),y=r(V,"TH",{"data-svelte-h":!0}),F(y)!=="svelte-m0r1hp"&&(y.textContent=d),o=E(V),p=r(V,"TH",{"data-svelte-h":!0}),F(p)!=="svelte-30jp5e"&&(p.textContent=tt),D=E(V),x=r(V,"TH",{"data-svelte-h":!0}),F(x)!=="svelte-10rrrw5"&&(x.textContent=K),V.forEach(c),G.forEach(c),z=E(L),W&&W.l(L),dt=E(L),ut=r(L,"TBODY",{id:!0});var gt=N(ut);for(let Ct=0;Ct<Q.length;Ct+=1)Q[Ct].l(gt);gt.forEach(c),L.forEach(c),ft=E(h),et=r(h,"DATALIST",{id:!0});var pt=N(et);nt=r(pt,"OPTION",{"data-svelte-h":!0}),F(nt)!=="svelte-1mqqvia"&&(nt.textContent=bt),lt=r(pt,"OPTION",{"data-svelte-h":!0}),F(lt)!=="svelte-1mkb7wl"&&(lt.textContent=Tt),ot=r(pt,"OPTION",{"data-svelte-h":!0}),F(ot)!=="svelte-10956bv"&&(ot.textContent=yt),pt.forEach(c),this.h()},h(){g(T,"type","button"),g(_,"type","button"),g(j,"type","checkbox"),j.checked=l[6],g(ut,"id","column-list-body"),g(O,"id","column-list-container"),nt.__value="text",Y(nt,nt.__value),lt.__value="number-integer",Y(lt,lt.__value),ot.__value="number-real",Y(ot,ot.__value),g(et,"id","column-types")},m(h,L){X(h,t,L),X(h,i,L),X(h,s,L),X(h,v,L),X(h,T,L),X(h,b,L),X(h,_,L),X(h,I,L),X(h,O,L),n(O,U),n(U,m),n(m,B),n(B,j),n(m,P),n(m,S),n(m,H),n(m,A),n(m,J),n(m,$),n(m,w),n(m,y),n(m,o),n(m,p),n(m,D),n(m,x),n(O,z),W&&W.m(O,null),n(O,dt),n(O,ut);for(let G=0;G<Q.length;G+=1)Q[G]&&Q[G].m(ut,null);X(h,ft,L),X(h,et,L),n(et,nt),n(et,lt),n(et,ot),vt||(kt=[M(T,"click",l[17]),M(_,"click",l[15]),M(j,"click",l[8])],vt=!0)},p(h,L){if(L[0]&64&&(j.checked=h[6]),h[3]?W?W.p(h,L):(W=wt(h),W.c(),W.m(O,dt)):W&&(W.d(1),W=null),L[0]&30887){it=ht(h[1]);let G;for(G=0;G<it.length;G+=1){const V=Ot(h,it,G);Q[G]?Q[G].p(V,L):(Q[G]=Pt(V),Q[G].c(),Q[G].m(ut,null))}for(;G<Q.length;G+=1)Q[G].d(1);Q.length=it.length}},i:ct,o:ct,d(h){h&&(c(t),c(i),c(s),c(v),c(T),c(b),c(_),c(I),c(O),c(ft),c(et)),W&&W.d(),xt(Q,h),vt=!1,mt(kt)}}}const St=7;function Wt(l,t,e){let i,s,{data:u}=t,v=[],T=-1,f=!1,b={},_={};const C={text:"Text","number-integer":"Number Integer","number-real":"Number Real"};function I(){s?e(0,v=[]):e(0,v=i.filter(D=>D.idx>St).map(D=>D.idx))}function O(){e(4,b={}),e(3,f=!1)}async function U(){const x=await fetch("/api/admin/user-columns",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(b)});x.ok||alert(await x.text()),O(),_t()}function m(D){e(2,T=D),e(5,_={});for(const x in u.columns[D])e(5,_[x]=u.columns[D][x],_)}function B(){e(5,_={}),e(2,T=-1)}async function j(){const x=await fetch("/api/admin/user-columns",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify([_])});x.ok||alert(await x.text()),B(),_t()}async function P(D){const x=i[D].idx,z=await fetch("/api/admin/user-columns",{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify([{idx:parseInt(x)}])});z.ok||alert(await z.text()),e(0,v=[]),_t()}async function S(){const D=[];for(let z=0;z<v.length;z++)D.push({idx:parseInt(v[z])});const K=await fetch("/api/admin/user-columns",{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(D)});K.ok||alert(await K.text()),e(0,v=[]),_t()}const R=[[]],H=()=>{e(3,f=!0)};function A(){b["display-name"]=this.value,e(4,b),e(7,C)}function Z(){b["column-code"]=this.value,e(4,b),e(7,C)}function J(){b["column-type"]=Rt(this),e(4,b),e(7,C)}function $(){b["column-name"]=this.value,e(4,b),e(7,C)}function q(){_["display-name"]=this.value,e(5,_)}function w(){_["column-code"]=this.value,e(5,_)}function y(){_["column-name"]=this.value,e(5,_)}function d(){_["sort-order"]=jt(this.value),e(5,_)}function o(){v=zt(R[0],this.__value,this.checked),e(0,v)}const p=D=>m(D),tt=D=>P(D);return l.$$set=D=>{"data"in D&&e(16,u=D.data)},l.$$.update=()=>{l.$$.dirty[0]&65536&&e(1,i=u.columns),l.$$.dirty[0]&3&&e(6,s=v.length==i.length-St)},[v,i,T,f,b,_,s,C,I,O,U,m,B,j,P,S,u,H,A,Z,J,$,q,w,y,d,o,R,p,tt]}class ne extends Ht{constructor(t){super(),Lt(this,t,Wt,Vt,At,{data:16},null,[-1,-1])}}export{ne as component,ee as universal};
